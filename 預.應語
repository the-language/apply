(定詞法# 定詞法
      (入 (名 . 體)
         (若 (首尾？ 名)
            `(定詞法# ,(首 名)
                   (入 ,(尾 名)
                      ,@體))
            (用 (入 (名 值) `(定詞法# ,名 ,值)) 名 體))))
(定詞法 (quasiquote x)
  (定 (Q 計 甲)
    (若.
      [(首尾？ 甲)
       (名 ([甲首 (首 甲)])
         (若.
           [(等？ 甲首 'unquote)
            (若 (零？ 計)
                (第二 甲)
                `(表 'unquote ,(Q (減一 計) (第二 甲))))]
           [(皆 (首尾？ 甲首) (等？ (第一 甲首) 'unquote-splicing))
            (若 (零？ 計)
               `(連 ,(第二 甲首) ,(Q 0 (尾 甲)))
               `(首尾 (表 'unquote-splicing ,(Q (減一 計) (第二 甲首))) ,(Q 計 (尾 甲))))]
           [(等？ f 'quasiquote) `(表 'quasiquote ,(Q (加一 計) (第二 甲)))]
           [否則 `(連 ,(Q 計 甲首) ,(Q 計 (尾 甲)))]))]
      [否則 `(quote ,甲)]))
  (Q 0 甲))